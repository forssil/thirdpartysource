/**************************************************
*         Copyright 2014 GaoH Inc.
*         Author:  Gu Cheng
*         History: 10/15/2014
*         Content: The Fourier Transform
***************************************************/

#include "T2Ftransformer.h"
#include<cstdlib>
#include<cstring>
#include<cmath>
#include "fft1536.h"
//#include "fft.h"
static const float hwin1536[] =
{ 0.00108705092917258f, 0.00217406974445722f, 0.00326102433291398f, 0.00434788258350081f, 0.00543461238802216f, 0.00652118164207615f, 0.00760755824600454f, 0.00869371010584017f, 0.00977960513425514f, 0.0108652112515094f, 0.0119504963863975f, 0.0130354284771968f, 0.0141199754726144f,
 0.0152041053327337f, 0.0162877860299613f, 0.0173709855499732f, 0.0184536718926604f, 0.0195358130730742f, 0.0206173771223712f, 0.0216983320887578f, 0.0227786460384340f, 0.0238582870565370f, 0.0249372232480837f, 0.0260154227389131f, 0.0270928536766282f, 0.0281694842315367f, 0.0292452825975911f,
 0.0303202169933289f, 0.0313942556628112f, 0.0324673668765605f, 0.0335395189324989f, 0.0346106801568837f, 0.0356808189052437f, 0.0367499035633141f, 0.0378179025479699f, 0.0388847843081596f, 0.0399505173258368f, 0.0410150701168916f, 0.0420784112320805f, 0.0431405092579557f, 0.0442013328177930f,
 0.0452608505725185f, 0.0463190312216351f, 0.0473758435041463f, 0.0484312561994806f, 0.0494852381284131f, 0.0505377581539869f, 0.0515887851824333f, 0.0526382881640896f, 0.0536862360943171f, 0.0547325980144166f, 0.0557773430125432f, 0.0568204402246196f, 0.0578618588352475f, 0.0589015680786183f,
 0.0599395372394219f, 0.0609757356537541f, 0.0620101327100224f, 0.0630426978498505f, 0.0640734005689809f, 0.0651022104181761f, 0.0661290970041183f, 0.0671540299903069f, 0.0681769790979552f, 0.0691979141068845f, 0.0702168048564172f, 0.0712336212462674f, 0.0722483332374306f, 0.0732609108530708f,
 0.0742713241794061f, 0.0752795433665926f, 0.0762855386296061f, 0.0772892802491220f, 0.0782907385723934f, 0.0792898840141268f, 0.0802866870573567f, 0.0812811182543169f, 0.0822731482273109f, 0.0832627476695797f, 0.0842498873461675f, 0.0852345380947854f, 0.0862166708266731f, 0.0871962565274579f, 0.0881732662580120f, 0.0891476711553076f, 0.0901194424332695f, 0.0910885513836252f, 0.0920549693767533f, 0.0930186678625295f, 0.0939796183711693f,
 0.0949377925140700f, 0.0958931619846485f, 0.0968456985591781f, 0.0977953740976222f, 0.0987421605444653f, 0.0996860299295422f, 0.100626954368864f, 0.101564906065443f, 0.102499857310110f, 0.103431780482340f, 0.104360648051061f, 0.105286432575471f, 0.106209106705848f, 0.107128643184358f,
 0.108045014845860f, 0.108958194618708f, 0.109868155525554f, 0.110774870684139f, 0.111678313308094f, 0.112578456707724f, 0.113475274290804f, 0.114368739563359f, 0.115258826130450f, 0.116145507696950f, 0.117028758068327f, 0.117908551151410f, 0.118784860955166f, 0.119657661591467f,
 0.120526927275851f, 0.121392632328289f, 0.122254751173937f, 0.123113258343900f, 0.123968128475978f, 0.124819336315415f, 0.125666856715651f, 0.126510664639058f, 0.127350735157686f, 0.128187043453992f, 0.129019564821581f, 0.129848274665930f, 0.130673148505119f, 0.131494161970550f,
 0.132311290807669f, 0.133124510876685f, 0.133933798153278f, 0.134739128729311f, 0.135540478813541f, 0.136337824732312f, 0.137131142930263f, 0.137920409971021f, 0.138705602537892f, 0.139486697434550f, 0.140263671585727f, 0.141036502037886f, 0.141805165959909f, 0.142569640643762f,
 0.143329903505173f, 0.144085932084296f, 0.144837704046376f, 0.145585197182405f, 0.146328389409784f, 0.147067258772971f, 0.147801783444132f, 0.148531941723782f, 0.149257712041433f, 0.149979072956224f, 0.150696003157558f, 0.151408481465733f, 0.152116486832562f, 0.152819998342003f,
 0.153518995210770f, 0.154213456788949f, 0.154903362560610f, 0.155588692144410f, 0.156269425294199f, 0.156945541899614f, 0.157617021986675f, 0.158283845718376f, 0.158945993395269f, 0.159603445456048f, 0.160256182478125f, 0.160904185178204f, 0.161547434412854f, 0.162185911179070f,
 0.162819596614835f, 0.163448471999682f, 0.164072518755240f, 0.164691718445788f, 0.165306052778799f, 0.165915503605478f, 0.166520052921299f, 0.167119682866539f, 0.167714375726804f, 0.168304113933552f, 0.168888880064611f, 0.169468656844697f, 0.170043427145923f, 0.170613173988302f,
 0.171177880540252f, 0.171737530119095f, 0.172292106191543f, 0.172841592374193f, 0.173385972434008f, 0.173925230288797f, 0.174459350007691f, 0.174988315811613f, 0.175512112073743f, 0.176030723319980f, 0.176544134229403f, 0.177052329634717f, 0.177555294522706f, 0.178053014034676f,
 0.178545473466892f, 0.179032658271012f, 0.179514554054522f, 0.179991146581152f, 0.180462421771307f, 0.180928365702475f, 0.181388964609642f, 0.181844204885699f, 0.182294073081839f, 0.182738555907963f, 0.183177640233065f, 0.183611313085622f, 0.184039561653980f, 0.184462373286729f,
 0.184879735493079f, 0.185291635943227f, 0.185698062468723f, 0.186099003062828f, 0.186494445880871f, 0.186884379240597f, 0.187268791622512f, 0.187647671670224f, 0.188021008190779f, 0.188388790154990f, 0.188751006697766f, 0.189107647118427f, 0.189458700881028f, 0.189804157614665f,
 0.190144007113781f, 0.190478239338470f, 0.190806844414775f, 0.191129812634973f, 0.191447134457870f, 0.191758800509078f, 0.192064801581292f, 0.192365128634564f, 0.192659772796568f, 0.192948725362865f, 0.193231977797156f, 0.193509521731539f, 0.193781348966752f, 0.194047451472418f,
 0.194307821387279f, 0.194562451019433f, 0.194811332846557f, 0.195054459516133f, 0.195291823845660f, 0.195523418822871f, 0.195749237605939f, 0.195969273523678f, 0.196183520075739f, 0.196391970932806f, 0.196594619936780f, 0.196791461100961f, 0.196982488610226f, 0.197167696821200f,
 0.197347080262422f, 0.197520633634509f, 0.197688351810311f, 0.197850229835062f, 0.198006262926528f, 0.198156446475145f, 0.198300776044159f, 0.198439247369756f, 0.198571856361187f, 0.198698599100889f, 0.198819471844601f, 0.198934471021475f, 0.199043593234181f, 0.199146835259007f,
 0.199244194045956f, 0.199335666718834f, 0.199421250575337f, 0.199500943087126f, 0.199574741899911f, 0.199642644833509f, 0.199704649881920f, 0.199760755213375f, 0.199810959170401f, 0.199855260269860f, 0.199893657203001f, 0.199926148835494f, 0.199952734207462f, 0.199973412533517f,
 0.199988183202774f, 0.199997045778875f, 0.199997045778875f, 0.199988183202774f, 0.199973412533517f, 0.199952734207462f, 0.199926148835494f, 0.199893657203001f, 0.199855260269860f, 0.199810959170401f, 0.199760755213375f, 0.199704649881920f, 0.199642644833509f, 0.199574741899911f,
 0.199500943087126f, 0.199421250575337f, 0.199335666718834f, 0.199244194045956f, 0.199146835259007f, 0.199043593234181f, 0.198934471021475f, 0.198819471844601f, 0.198698599100889f, 0.198571856361187f, 0.198439247369756f, 0.198300776044159f, 0.198156446475145f, 0.198006262926528f,
 0.197850229835062f, 0.197688351810311f, 0.197520633634509f, 0.197347080262422f, 0.197167696821200f, 0.196982488610226f, 0.196791461100961f, 0.196594619936780f, 0.196391970932806f, 0.196183520075739f, 0.195969273523678f, 0.195749237605939f, 0.195523418822871f, 0.195291823845660f,
 0.195054459516133f, 0.194811332846557f, 0.194562451019433f, 0.194307821387279f, 0.194047451472418f, 0.193781348966752f, 0.193509521731539f, 0.193231977797156f, 0.192948725362865f, 0.192659772796568f, 0.192365128634564f, 0.192064801581292f, 0.191758800509078f, 0.191447134457870f,
 0.191129812634973f, 0.190806844414775f, 0.190478239338470f, 0.190144007113781f, 0.189804157614665f, 0.189458700881028f, 0.189107647118427f, 0.188751006697766f, 0.188388790154990f, 0.188021008190779f, 0.187647671670224f, 0.187268791622512f, 0.186884379240597f, 0.186494445880871f,
 0.186099003062828f, 0.185698062468723f, 0.185291635943227f, 0.184879735493079f, 0.184462373286729f, 0.184039561653980f, 0.183611313085622f, 0.183177640233065f, 0.182738555907963f, 0.182294073081839f, 0.181844204885699f, 0.181388964609642f, 0.180928365702475f, 0.180462421771307f,
 0.179991146581152f, 0.179514554054522f, 0.179032658271012f, 0.178545473466892f, 0.178053014034676f, 0.177555294522706f, 0.177052329634717f, 0.176544134229403f, 0.176030723319980f, 0.175512112073743f, 0.174988315811613f, 0.174459350007691f, 0.173925230288797f, 0.173385972434008f,
 0.172841592374193f, 0.172292106191543f, 0.171737530119095f, 0.171177880540252f, 0.170613173988302f, 0.170043427145923f, 0.169468656844697f, 0.168888880064611f, 0.168304113933552f, 0.167714375726804f, 0.167119682866539f, 0.166520052921299f, 0.165915503605478f, 0.165306052778799f,
 0.164691718445788f, 0.164072518755240f, 0.163448471999682f, 0.162819596614835f, 0.162185911179070f, 0.161547434412854f, 0.160904185178204f, 0.160256182478125f, 0.159603445456048f, 0.158945993395269f, 0.158283845718376f, 0.157617021986675f, 0.156945541899614f, 0.156269425294199f,
 0.155588692144410f, 0.154903362560610f, 0.154213456788949f, 0.153518995210770f, 0.152819998342003f, 0.152116486832562f, 0.151408481465733f, 0.150696003157558f, 0.149979072956224f, 0.149257712041433f, 0.148531941723782f, 0.147801783444132f, 0.147067258772971f, 0.146328389409784f,
 0.145585197182405f, 0.144837704046376f, 0.144085932084296f, 0.143329903505173f, 0.142569640643762f, 0.141805165959909f, 0.141036502037886f, 0.140263671585727f, 0.139486697434550f, 0.138705602537892f, 0.137920409971021f, 0.137131142930263f, 0.136337824732312f, 0.135540478813541f,
 0.134739128729311f, 0.133933798153278f, 0.133124510876685f, 0.132311290807669f, 0.131494161970550f, 0.130673148505119f, 0.129848274665930f, 0.129019564821581f, 0.128187043453992f, 0.127350735157686f, 0.126510664639058f, 0.125666856715651f, 0.124819336315415f, 0.123968128475978f,
 0.123113258343900f, 0.122254751173937f, 0.121392632328289f, 0.120526927275851f, 0.119657661591467f, 0.118784860955166f, 0.117908551151410f, 0.117028758068327f, 0.116145507696950f, 0.115258826130450f, 0.114368739563359f, 0.113475274290804f, 0.112578456707724f, 0.111678313308094f,
 0.110774870684139f, 0.109868155525554f, 0.108958194618708f, 0.108045014845860f, 0.107128643184358f, 0.106209106705848f, 0.105286432575471f, 0.104360648051061f, 0.103431780482340f, 0.102499857310110f, 0.101564906065443f, 0.100626954368864f, 0.0996860299295422f, 0.0987421605444653f,
 0.0977953740976222f, 0.0968456985591781f, 0.0958931619846485f, 0.0949377925140700f, 0.0939796183711693f, 0.0930186678625295f, 0.0920549693767533f, 0.0910885513836252f, 0.0901194424332695f, 0.0891476711553076f, 0.0881732662580120f, 0.0871962565274579f, 0.0862166708266731f, 0.0852345380947854f,
 0.0842498873461675f, 0.0832627476695797f, 0.0822731482273109f, 0.0812811182543169f, 0.0802866870573567f, 0.0792898840141268f, 0.0782907385723934f, 0.0772892802491220f, 0.0762855386296061f, 0.0752795433665926f, 0.0742713241794061f, 0.0732609108530708f, 0.0722483332374306f, 0.0712336212462674f,
 0.0702168048564172f, 0.0691979141068845f, 0.0681769790979552f, 0.0671540299903069f, 0.0661290970041183f, 0.0651022104181761f, 0.0640734005689809f, 0.0630426978498505f, 0.0620101327100224f, 0.0609757356537541f, 0.0599395372394219f, 0.0589015680786183f, 0.0578618588352475f, 0.0568204402246196f,
 0.0557773430125432f, 0.0547325980144166f, 0.0536862360943171f, 0.0526382881640896f, 0.0515887851824333f, 0.0505377581539869f, 0.0494852381284131f, 0.0484312561994806f, 0.0473758435041463f, 0.0463190312216351f, 0.0452608505725185f, 0.0442013328177930f, 0.0431405092579557f, 0.0420784112320805f,
 0.0410150701168916f, 0.0399505173258368f, 0.0388847843081596f, 0.0378179025479699f, 0.0367499035633141f, 0.0356808189052437f, 0.0346106801568837f, 0.0335395189324989f, 0.0324673668765605f, 0.0313942556628112f, 0.0303202169933289f, 0.0292452825975911f, 0.0281694842315367f, 0.0270928536766282f,
 0.0260154227389131f, 0.0249372232480837f, 0.0238582870565370f, 0.0227786460384340f, 0.0216983320887578f, 0.0206173771223712f, 0.0195358130730742f, 0.0184536718926604f, 0.0173709855499732f, 0.0162877860299613f, 0.0152041053327337f, 0.0141199754726144f, 0.0130354284771968f, 0.0119504963863975f,
 0.0108652112515094f, 0.00977960513425514f, 0.00869371010584017f, 0.00760755824600454f, 0.00652118164207615f, 0.00543461238802216f, 0.00434788258350081f, 0.00326102433291398f, 0.00217406974445722f, 0.00108705092917258f, 0.00326568302449060f, 0.00653133122139654f,
 0.00979690976353120f, 0.0130623838244212f, 0.0163277185787226f, 0.0195928792025757f, 0.0228578308739732f, 0.0261225387731415f, 0.0293869680829034f, 0.0326510839890541f, 0.0359148516807302f, 0.0391782363507831f, 0.0424412031961482f, 0.0457037174182177f, 0.0489657442232096f, 0.0522272488225408f,
 0.0554881964331982f, 0.0587485522781072f, 0.0620082815865051f, 0.0652673495943116f, 0.0685257215444972f, 0.0717833626874582f, 0.0750402382813820f, 0.0782963135926225f, 0.0815515538960670f, 0.0848059244755092f, 0.0880593906240170f, 0.0913119176443041f, 0.0945634708491004f, 0.0978140155615206f,
 0.101063517115434f, 0.104311940855837f, 0.107559252139219f, 0.110805416333933f, 0.114050398820567f, 0.117294164992310f, 0.120536680255323f, 0.123777910029109f, 0.127017819746879f, 0.130256374855922f, 0.133493540817973f, 0.136729283109585f, 0.139963567222489f, 0.143196358663972f,
 0.146427622957236f, 0.149657325641773f, 0.152885432273726f, 0.156111908426262f, 0.159336719689934f, 0.162559831673053f, 0.165781210002051f, 0.169000820321849f, 0.172218628296224f, 0.175434599608175f, 0.178648699960286f, 0.181860895075097f, 0.185071150695464f, 0.188279432584931f,
 0.191485706528087f, 0.194689938330938f, 0.197892093821269f, 0.201092138849006f, 0.204290039286585f, 0.207485761029311f, 0.210679269995726f, 0.213870532127971f, 0.217059513392146f, 0.220246179778680f, 0.223430497302685f, 0.226612432004326f, 0.229791949949180f, 0.232969017228596f,
 0.236143599960061f, 0.239315664287558f, 0.242485176381927f, 0.245652102441229f, 0.248816408691102f, 0.251978061385125f, 0.255137026805177f, 0.258293271261794f, 0.261446761094532f, 0.264597462672324f, 0.267745342393837f, 0.270890366687836f, 0.274032502013535f, 0.277171714860960f, 0.280307971751302f, 0.283441239237280f, 0.286571483903491f, 0.289698672366772f, 0.292822771276550f, 0.295943747315206f, 0.299061567198422f,
 0.302176197675540f, 0.305287605529916f, 0.308395757579277f, 0.311500620676069f, 0.314602161707814f, 0.317700347597466f, 0.320795145303756f, 0.323886521821554f, 0.326974444182211f, 0.330058879453919f, 0.333139794742058f, 0.336217157189547f, 0.339290933977196f, 0.342361092324054f, 0.345427599487760f, 0.348490422764893f, 0.351549529491318f, 0.354604887042536f, 0.357656462834033f, 0.360704224321625f, 0.363748139001808f,
 0.366788174412103f, 0.369824298131400f, 0.372856477780309f, 0.375884681021500f, 0.378908875560052f, 0.381929029143796f, 0.384945109563656f, 0.387957084653997f, 0.390964922292967f, 0.393968590402836f, 0.396968056950344f, 0.399963289947038f, 0.402954257449613f, 0.405940927560258f, 0.408923268426988f, 0.411901248243993f, 0.414874835251967f, 0.417843997738458f, 0.420808704038194f, 0.423768922533432f, 0.426724621654288f,
 0.429675769879075f, 0.432622335734643f, 0.435564287796707f, 0.438501594690192f, 0.441434225089559f, 0.444362147719143f, 0.447285331353487f, 0.450203744817673f, 0.453117356987657f, 0.456026136790596f, 0.458930053205187f, 0.461829075261992f, 0.464723172043769f, 0.467612312685803f, 0.470496466376236f, 0.473375602356393f, 0.476249689921113f, 0.479118698419073f, 0.481982597253118f, 0.484841355880587f, 0.487694943813635f,
 0.490543330619563f, 0.493386485921141f, 0.496224379396930f, 0.499056980781608f, 0.501884259866291f, 0.504706186498857f, 0.507522730584263f, 0.510333862084874f, 0.513139551020776f, 0.515939767470098f, 0.518734481569332f, 0.521523663513653f, 0.524307283557232f, 0.527085312013557f, 0.529857719255749f, 0.532624475716878f, 0.535385551890277f, 0.538140918329858f, 0.540890545650427f, 0.543634404527993f, 0.546372465700088f,
 0.549104699966070f, 0.551831078187444f, 0.554551571288165f, 0.557266150254951f, 0.559974786137595f, 0.562677450049270f, 0.565374113166837f, 0.568064746731156f, 0.570749322047389f, 0.573427810485307f, 0.576100183479598f, 0.578766412530168f, 0.581426469202446f, 0.584080325127689f, 0.586727952003282f, 0.589369321593042f, 0.592004405727516f, 0.594633176304287f, 0.597255605288267f, 0.599871664712002f, 0.602481326675966f,
 0.605084563348861f, 0.607681346967910f, 0.610271649839161f, 0.612855444337773f, 0.615432702908317f, 0.618003398065067f, 0.620567502392294f, 0.623124988544560f, 0.625675829247005f, 0.628219997295642f, 0.630757465557648f, 0.633288206971649f, 0.635812194548010f, 0.638329401369127f, 0.640839800589708f, 0.643343365437064f, 0.645840069211391f, 0.648329885286058f, 0.650812787107888f, 0.653288748197443f, 0.655757742149306f,
 0.658219742632362f, 0.660674723390082f, 0.663122658240795f, 0.665563521077978f, 0.667997285870527f, 0.670423926663035f, 0.672843417576073f, 0.675255732806462f, 0.677660846627549f, 0.680058733389484f, 0.682449367519490f, 0.684832723522137f, 0.687208775979615f, 0.689577499552005f, 0.691938868977546f, 0.694292859072910f, 0.696639444733464f, 0.698978600933543f, 0.701310302726717f, 0.703634525246051f, 0.705951243704377f,
 0.708260433394556f, 0.710562069689739f, 0.712856128043634f, 0.715142583990764f, 0.717421413146731f, 0.719692591208472f, 0.721956093954524f, 0.724211897245278f, 0.726459977023235f, 0.728700309313268f, 0.730932870222874f, 0.733157635942429f, 0.735374582745442f, 0.737583686988811f, 0.739784925113070f, 0.741978273642643f, 0.744163709186097f, 0.746341208436385f, 0.748510748171101f, 0.750672305252724f, 0.752825856628867f,
 0.754971379332518f, 0.757108850482293f, 0.759238247282672f, 0.761359547024247f, 0.763472727083964f, 0.765577764925362f, 0.767674638098813f, 0.769763324241765f, 0.771843801078977f, 0.773916046422759f, 0.775980038173207f, 0.778035754318440f, 0.780083172934831f, 0.782122272187247f, 0.784153030329278f, 0.786175425703469f, 0.788189436741551f, 0.790195041964673f, 0.792192219983628f, 0.794180949499084f, 0.796161209301809f,
 0.798132978272899f, 0.800096235384001f, 0.802050959697540f, 0.803997130366941f, 0.805934726636848f, 0.807863727843352f, 0.809784113414208f, 0.811695862869051f, 0.813598955819621f, 0.815493371969975f, 0.817379091116707f, 0.819256093149161f, 0.821124358049648f, 0.822983865893656f, 0.824834596850067f, 0.826676531181363f, 0.828509649243842f, 0.830333931487824f, 0.832149358457860f, 0.833955910792941f, 0.835753569226702f,
 0.837542314587631f, 0.839322127799270f, 0.841092989880420f, 0.842854881945342f, 0.844607785203963f, 0.846351680962070f, 0.848086550621513f, 0.849812375680404f, 0.851529137733311f, 0.853236818471459f, 0.854935399682921f, 0.856624863252814f, 0.858305191163491f, 0.859976365494736f, 0.861638368423954f, 0.863291182226357f, 0.864934789275160f, 0.866569172041762f, 0.868194313095940f, 0.869810195106029f, 0.871416800839108f,
 0.873014113161188f, 0.874602115037389f, 0.876180789532125f, 0.877750119809285f, 0.879310089132408f, 0.880860680864870f, 0.882401878470052f, 0.883933665511522f, 0.885456025653210f, 0.886968942659580f, 0.888472400395805f, 0.889966382827939f, 0.891450874023084f, 0.892925858149569f, 0.894391319477107f, 0.895847242376975f, 0.897293611322169f, 0.898730410887580f, 0.900157625750150f, 0.901575240689041f, 0.902983240585795f,
 0.904381610424496f, 0.905770335291929f, 0.907149400377741f, 0.908518790974597f, 0.909878492478338f, 0.911228490388136f, 0.912568770306649f, 0.913899317940175f, 0.915220119098805f, 0.916531159696571f, 0.917832425751601f, 0.919123903386264f, 0.920405578827320f, 0.921677438406068f, 0.922939468558489f, 0.924191655825391f, 0.925433986852556f, 0.926666448390879f, 0.927889027296509f, 0.929101710530993f, 0.930304485161410f,
 0.931497338360514f, 0.932680257406864f, 0.933853229684970f, 0.935016242685415f, 0.936169284004999f, 0.937312341346867f, 0.938445402520639f, 0.939568455442540f, 0.940681488135534f, 0.941784488729444f, 0.942877445461084f, 0.943960346674384f, 0.945033180820512f, 0.946095936457998f, 0.947148602252858f, 0.948191166978711f, 0.949223619516903f, 0.950245948856623f, 0.951258144095021f, 0.952260194437324f, 0.953252089196952f,
 0.954233817795630f, 0.955205369763505f, 0.956166734739251f, 0.957117902470187f, 0.958058862812380f, 0.958989605730758f, 0.959910121299214f, 0.960820399700711f, 0.961720431227393f, 0.962610206280678f, 0.963489715371372f, 0.964358949119760f, 0.965217898255714f, 0.966066553618787f, 0.966904906158312f, 0.967732946933499f, 0.968550667113529f, 0.969358057977652f, 0.970155110915273f, 0.970941817426052f, 0.971718169119989f,
 0.972484157717514f, 0.973239775049578f, 0.973985013057739f, 0.974719863794247f, 0.975444319422128f, 0.976158372215270f, 0.976862014558504f, 0.977555238947686f, 0.978238037989777f, 0.978910404402919f, 0.979572331016517f, 0.980223810771313f, 0.980864836719461f, 0.981495402024604f, 0.982115499961943f, 0.982725123918310f, 0.983324267392240f, 0.983912923994039f, 0.984491087445854f, 0.985058751581735f, 0.985615910347709f,
 0.986162557801834f, 0.986698688114274f, 0.987224295567351f, 0.987739374555611f, 0.988243919585886f, 0.988737925277347f, 0.989221386361563f, 0.989694297682562f, 0.990156654196878f, 0.990608450973612f, 0.991049683194481f, 0.991480346153868f, 0.991900435258877f, 0.992309946029377f, 0.992708874098054f, 0.993097215210453f, 0.993474965225028f, 0.993842120113182f, 0.994198675959313f, 0.994544628960857f, 0.994879975428322f,
 0.995204711785334f, 0.995518834568674f, 0.995822340428311f, 0.996115226127443f, 0.996397488542527f, 0.996669124663314f, 0.996930131592884f, 0.997180506547673f, 0.997420246857502f, 0.997649349965611f, 0.997867813428680f, 0.998075634916858f, 0.998272812213789f, 0.998459343216633f, 0.998635225936091f, 0.998800458496424f, 0.998955039135474f, 0.999098966204681f, 0.999232238169107f, 0.999354853607442f, 0.999466811212028f,
 0.999568109788870f, 0.999658748257647f, 0.999738725651726f, 0.999808041118171f, 0.999866693917751f, 0.999914683424953f, 0.999952009127981f, 0.999978670628767f, 0.999994667642975f, 0.999994667642975f, 0.999978670628767f, 0.999952009127981f, 0.999914683424953f, 0.999866693917751f, 0.999808041118171f, 0.999738725651726f, 0.999658748257647f, 0.999568109788870f, 0.999466811212028f, 0.999354853607442f, 0.999232238169107f,
 0.999098966204681f, 0.998955039135474f, 0.998800458496424f, 0.998635225936091f, 0.998459343216633f, 0.998272812213789f, 0.998075634916858f, 0.997867813428680f, 0.997649349965611f, 0.997420246857502f, 0.997180506547673f, 0.996930131592884f, 0.996669124663314f, 0.996397488542527f, 0.996115226127443f, 0.995822340428311f, 0.995518834568674f, 0.995204711785334f, 0.994879975428322f, 0.994544628960857f, 0.994198675959313f,
 0.993842120113182f, 0.993474965225028f, 0.993097215210453f, 0.992708874098054f, 0.992309946029377f, 0.991900435258877f, 0.991480346153868f, 0.991049683194481f, 0.990608450973612f, 0.990156654196878f, 0.989694297682562f, 0.989221386361563f, 0.988737925277347f, 0.988243919585886f, 0.987739374555611f, 0.987224295567351f, 0.986698688114274f, 0.986162557801834f, 0.985615910347709f, 0.985058751581735f, 0.984491087445854f,
 0.983912923994039f, 0.983324267392240f, 0.982725123918310f, 0.982115499961943f, 0.981495402024604f, 0.980864836719461f, 0.980223810771313f, 0.979572331016517f, 0.978910404402919f, 0.978238037989777f, 0.977555238947686f, 0.976862014558504f, 0.976158372215270f, 0.975444319422128f, 0.974719863794247f, 0.973985013057739f, 0.973239775049578f, 0.972484157717514f, 0.971718169119989f, 0.970941817426052f, 0.970155110915273f,
 0.969358057977652f, 0.968550667113529f, 0.967732946933499f, 0.966904906158312f, 0.966066553618787f, 0.965217898255714f, 0.964358949119760f, 0.963489715371372f, 0.962610206280678f, 0.961720431227393f, 0.960820399700711f, 0.959910121299214f, 0.958989605730758f, 0.958058862812380f, 0.957117902470187f, 0.956166734739251f, 0.955205369763505f, 0.954233817795630f, 0.953252089196952f, 0.952260194437324f, 0.951258144095021f,
 0.950245948856623f, 0.949223619516903f, 0.948191166978711f, 0.947148602252858f, 0.946095936457998f, 0.945033180820512f, 0.943960346674384f, 0.942877445461084f, 0.941784488729444f, 0.940681488135534f, 0.939568455442540f, 0.938445402520639f, 0.937312341346867f, 0.936169284004999f, 0.935016242685415f, 0.933853229684970f, 0.932680257406864f, 0.931497338360514f, 0.930304485161410f, 0.929101710530993f, 0.927889027296509f,
 0.926666448390879f, 0.925433986852556f, 0.924191655825391f, 0.922939468558489f, 0.921677438406068f, 0.920405578827320f, 0.919123903386264f, 0.917832425751601f, 0.916531159696571f, 0.915220119098805f, 0.913899317940175f, 0.912568770306649f, 0.911228490388136f, 0.909878492478338f, 0.908518790974597f, 0.907149400377741f, 0.905770335291929f, 0.904381610424496f, 0.902983240585795f, 0.901575240689041f, 0.900157625750150f,
 0.898730410887580f, 0.897293611322169f, 0.895847242376975f, 0.894391319477107f, 0.892925858149569f, 0.891450874023084f, 0.889966382827939f, 0.888472400395805f, 0.886968942659580f, 0.885456025653210f, 0.883933665511522f, 0.882401878470052f, 0.880860680864870f, 0.879310089132408f, 0.877750119809285f, 0.876180789532125f, 0.874602115037389f, 0.873014113161188f, 0.871416800839108f, 0.869810195106029f, 0.868194313095940f,
 0.866569172041762f, 0.864934789275160f, 0.863291182226357f, 0.861638368423954f, 0.859976365494736f, 0.858305191163491f, 0.856624863252814f, 0.854935399682921f, 0.853236818471459f, 0.851529137733311f, 0.849812375680404f, 0.848086550621513f, 0.846351680962070f, 0.844607785203963f, 0.842854881945342f, 0.841092989880420f, 0.839322127799270f, 0.837542314587631f, 0.835753569226702f, 0.833955910792941f, 0.832149358457860f,
 0.830333931487824f, 0.828509649243842f, 0.826676531181363f, 0.824834596850067f, 0.822983865893656f, 0.821124358049648f, 0.819256093149161f, 0.817379091116707f, 0.815493371969975f, 0.813598955819621f, 0.811695862869051f, 0.809784113414208f, 0.807863727843353f, 0.805934726636848f, 0.803997130366941f, 0.802050959697540f, 0.800096235384001f, 0.798132978272899f, 0.796161209301809f, 0.794180949499084f, 0.792192219983628f,
 0.790195041964673f, 0.788189436741551f, 0.786175425703469f, 0.784153030329278f, 0.782122272187247f, 0.780083172934831f, 0.778035754318440f, 0.775980038173207f, 0.773916046422759f, 0.771843801078977f, 0.769763324241765f, 0.767674638098813f, 0.765577764925362f, 0.763472727083964f, 0.761359547024247f, 0.759238247282672f, 0.757108850482293f, 0.754971379332518f, 0.752825856628866f, 0.750672305252724f, 0.748510748171101f,
 0.746341208436385f, 0.744163709186097f, 0.741978273642643f, 0.739784925113070f, 0.737583686988811f, 0.735374582745442f, 0.733157635942429f, 0.730932870222874f, 0.728700309313268f, 0.726459977023235f, 0.724211897245278f, 0.721956093954525f, 0.719692591208472f, 0.717421413146731f, 0.715142583990764f, 0.712856128043634f, 0.710562069689739f, 0.708260433394556f, 0.705951243704377f, 0.703634525246051f, 0.701310302726717f,
 0.698978600933543f, 0.696639444733464f, 0.694292859072910f, 0.691938868977546f, 0.689577499552005f, 0.687208775979615f, 0.684832723522137f, 0.682449367519490f, 0.680058733389484f, 0.677660846627549f, 0.675255732806462f, 0.672843417576073f, 0.670423926663035f, 0.667997285870527f, 0.665563521077978f, 0.663122658240795f, 0.660674723390082f, 0.658219742632362f, 0.655757742149306f, 0.653288748197443f, 0.650812787107888f,
 0.648329885286058f, 0.645840069211391f, 0.643343365437064f, 0.640839800589708f, 0.638329401369127f, 0.635812194548010f, 0.633288206971649f, 0.630757465557648f, 0.628219997295642f, 0.625675829247005f, 0.623124988544560f, 0.620567502392294f, 0.618003398065067f, 0.615432702908317f, 0.612855444337773f, 0.610271649839161f, 0.607681346967910f, 0.605084563348861f, 0.602481326675966f, 0.599871664712002f, 0.597255605288267f,
 0.594633176304287f, 0.592004405727516f, 0.589369321593042f, 0.586727952003282f, 0.584080325127689f, 0.581426469202446f, 0.578766412530168f, 0.576100183479598f, 0.573427810485307f, 0.570749322047389f, 0.568064746731156f, 0.565374113166837f, 0.562677450049270f, 0.559974786137595f, 0.557266150254951f, 0.554551571288165f, 0.551831078187444f, 0.549104699966070f, 0.546372465700088f, 0.543634404527993f, 0.540890545650427f,
 0.538140918329858f, 0.535385551890277f, 0.532624475716878f, 0.529857719255749f, 0.527085312013557f, 0.524307283557232f, 0.521523663513653f, 0.518734481569332f, 0.515939767470098f, 0.513139551020776f, 0.510333862084874f, 0.507522730584263f, 0.504706186498857f, 0.501884259866291f, 0.499056980781608f, 0.496224379396930f, 0.493386485921141f, 0.490543330619563f, 0.487694943813635f, 0.484841355880587f, 0.481982597253118f,
 0.479118698419073f, 0.476249689921113f, 0.473375602356393f, 0.470496466376236f, 0.467612312685803f, 0.464723172043769f, 0.461829075261992f, 0.458930053205187f, 0.456026136790596f, 0.453117356987657f, 0.450203744817673f, 0.447285331353487f, 0.444362147719143f, 0.441434225089559f, 0.438501594690192f, 0.435564287796707f, 0.432622335734643f, 0.429675769879075f, 0.426724621654288f, 0.423768922533432f, 0.420808704038194f,
 0.417843997738458f, 0.414874835251967f, 0.411901248243993f, 0.408923268426988f, 0.405940927560258f, 0.402954257449613f, 0.399963289947038f, 0.396968056950344f, 0.393968590402836f, 0.390964922292967f, 0.387957084653997f, 0.384945109563655f, 0.381929029143796f, 0.378908875560052f, 0.375884681021500f, 0.372856477780309f, 0.369824298131400f, 0.366788174412103f, 0.363748139001808f, 0.360704224321625f, 0.357656462834033f,
 0.354604887042536f, 0.351549529491318f, 0.348490422764893f, 0.345427599487760f, 0.342361092324054f, 0.339290933977196f, 0.336217157189547f, 0.333139794742058f, 0.330058879453919f, 0.326974444182211f, 0.323886521821554f, 0.320795145303756f, 0.317700347597466f, 0.314602161707814f,
 0.311500620676069f, 0.308395757579277f, 0.305287605529916f, 0.302176197675540f, 0.299061567198422f, 0.295943747315206f, 0.292822771276550f, 0.289698672366772f, 0.286571483903491f, 0.283441239237280f, 0.280307971751302f, 0.277171714860960f, 0.274032502013535f, 0.270890366687836f, 0.267745342393837f, 0.264597462672324f, 0.261446761094532f, 0.258293271261794f, 0.255137026805177f, 0.251978061385125f, 0.248816408691102f,
 0.245652102441229f, 0.242485176381927f, 0.239315664287558f, 0.236143599960061f, 0.232969017228596f, 0.229791949949180f, 0.226612432004326f, 0.223430497302685f, 0.220246179778680f, 0.217059513392146f, 0.213870532127971f, 0.210679269995726f, 0.207485761029311f, 0.204290039286585f, 0.201092138849006f, 0.197892093821269f, 0.194689938330938f, 0.191485706528087f, 0.188279432584931f, 0.185071150695464f, 0.181860895075097f,
 0.178648699960286f, 0.175434599608175f, 0.172218628296224f, 0.169000820321849f, 0.165781210002051f, 0.162559831673053f, 0.159336719689934f, 0.156111908426262f, 0.152885432273726f, 0.149657325641773f, 0.146427622957236f, 0.143196358663972f, 0.139963567222489f, 0.136729283109585f, 0.133493540817973f, 0.130256374855922f, 0.127017819746879f, 0.123777910029109f, 0.120536680255323f, 0.117294164992310f, 0.114050398820567f,
 0.110805416333933f, 0.107559252139219f, 0.104311940855837f, 0.101063517115434f, 0.0978140155615205f, 0.0945634708491004f, 0.0913119176443041f, 0.0880593906240170f, 0.0848059244755092f, 0.0815515538960670f, 0.0782963135926225f, 0.0750402382813820f, 0.0717833626874582f, 0.0685257215444972f, 0.0652673495943116f, 0.0620082815865051f, 0.0587485522781072f, 0.0554881964331982f, 0.0522272488225408f, 0.0489657442232096f, 0.0457037174182177f,
 0.0424412031961482f, 0.0391782363507831f, 0.0359148516807302f, 0.0326510839890541f, 0.0293869680829034f, 0.0261225387731415f, 0.0228578308739732f, 0.0195928792025757f, 0.0163277185787226f, 0.0130623838244212f, 0.00979690976353120f, 0.00653133122139654f, 0.00326568302449060f };

T2Ftransformer::T2Ftransformer(void): 
m_input_tim(NULL),
m_output_spe(NULL),
m_ana_win(NULL),
m_shift(0),
m_fft_len(0) {

}

T2Ftransformer::~T2Ftransformer(void) {
	FreeFDanaly();
}

/***************************************************
name:    InitFDanaly
para:    size  (IN)
content: initial parameter
***************************************************/
void T2Ftransformer::InitFDanaly(const int size,const int fft_size) {
	
	m_fft_len   = fft_size;

    const float inv_size = 1.0f / (float)1024;
    const float step = 2.0f * AUDIO_COMMON_PI / ((float)1024 - 1.0f);
    for (int i = 0; i < 1024; ++i) {
        float weight = (0.5f * (1.0f - cosf((float)i * step)));
        hwin1024_new[i] = weight;
        //hwin1024_new[i] = weight * inv_size;
    }

	const float *fp=NULL;
	switch(m_fft_len)
	{
	case 256:
		fp   = hwin256;
		break;
	case 512:
		fp   = hwin512;
		break;
	case 1024:
		fp   = size == 480? hwin1024_new:hwin1024;
		break;
	case 1536:
		fp = hwin1536;
		break;
	default:
		fp   = hwin256;
		m_fft_len=256;

	}
    m_framelen = size;
    m_shift = m_fft_len - size;
	m_ana_win=new float[m_fft_len];

	for(int i=0; i<m_fft_len; i++)
	{
		if (m_fft_len == 1536)
			m_ana_win[i] = (fp[i]);
		else
			m_ana_win[i] = sqrtf(fp[i]);
	}
	

	//m_input_tim  = new float[size*2];
	//m_output_spe = new float[size*2];

	//memset(m_input_tim,  0, sizeof(float)*size*2);
	//memset(m_output_spe, 0, sizeof(float)*size*2);

    m_input_tim = new float[m_fft_len];
    m_output_spe = new float[m_fft_len];

    memset(m_input_tim, 0, sizeof(float)*m_fft_len);
    memset(m_output_spe, 0, sizeof(float)*m_fft_len);

#ifdef ARM_NEON
	if (ne10_init() != NE10_OK)
	{
		return 1;
	}

	m_cfg = ne10_fft_alloc_r2c_float32(m_fft_len);
	m_pdst = new ne10_fft_cpx_float32_t[m_fft_len/2 +1];
	memset(m_pdst, 0, sizeof(ne10_fft_cpx_float32_t)*(m_fft_len / 2 + 1));

#endif
}

/***************************************************
name:    FreeFDanaly
content: release the allocated memory
***************************************************/
inline void T2Ftransformer::FreeFDanaly() {
	if(m_input_tim)	 delete []m_input_tim;
	if(m_output_spe) delete []m_output_spe;
	if( m_ana_win) delete m_ana_win;
#ifdef ARM_NEON
	ne10_fft_destroy_r2c_float32(m_cfg);
	if (m_pdst) delete[] m_pdst;

#endif
}

/***************************************************
name:    T2F
para:    inbuf   (IN)  
	     outbuf  (OUT)
content: the fourier transform
***************************************************/
void T2Ftransformer::T2F(const float* inbuf, float* outbuf) {
	//update buffer
	UpdateFDbuffer(inbuf);
	//multiple win
	for(int i = 0; i < m_fft_len; ++i)
		outbuf[i] = m_input_tim[i]*m_ana_win[i];
	//the fourier transform
#ifndef ARM_NEON
	wbxFFT(outbuf, m_output_spe, m_fft_len);
	//gh::FFT(outbuf, m_output_spe, m_fft_len);
#else
	ne10_fft_r2c_1d_float32(m_pdst, outbuf, m_cfg);
	for (int i = 0; i < m_fft_len; i += 2) {
		outbuf[i] = m_pdst[i / 2].r/ m_fft_len;
		outbuf[i+1] = m_pdst[i / 2].i/ m_fft_len;
	}
#endif
	//update buffer
	memcpy(m_input_tim, m_input_tim + m_framelen, sizeof(float)*m_shift);
}

/***************************************************
name:    UpdateFDbuffer
para:    data   (IN)  
content: update data
***************************************************/
inline void T2Ftransformer::UpdateFDbuffer(const float* data) {
	const float* fpin   = data;
	float* fpFDin = m_input_tim + m_shift;
	memcpy(fpFDin, fpin, sizeof(float)*m_framelen);
}
